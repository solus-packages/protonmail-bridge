name: protonmail-bridge
version: 1.6.3
release: 4
source:
    - https://github.com/ProtonMail/proton-bridge/archive/v1.6.3.tar.gz: a9834134452068bb7ffdfc5972510ead33ae04c2464a990d8ead51b98ddeee8a
license: GPL-3.0-or-later
component: network.mail
summary: ProtonMail Bridge for e-mail clients.
description: ProtonMail Bridge enables the integration of ProtonMail accounts with email clients through local IMAP/SMTP servers.
networking: true
builddeps:
    - pkgconfig(Qt5Gui)
    - pkgconfig(Qt5Qml)
    - pkgconfig(libsecret-1)
    - git
    - golang
rundeps:
    - gnome-keyring
    - qt5-graphicaleffects
    - qt5-quickcontrols2
build: |
    %patch -p1 < $pkgfiles/0001-add-missing-dependencies.patch
    export PATH=$PATH:$(go env GOPATH)/bin/
    export QT_PKG_CONFIG=true
    %make build
install: |
    install -D cmd/Desktop-Bridge/deploy/linux/proton-bridge $installdir/usr/bin/protonmail-bridge
    install -Dm00644 cmd/Desktop-Bridge/deploy/linux/logo.svg $installdir/usr/share/icons/hicolor/scalable/apps/protonmail-bridge.svg
    install -Dm00644 dist/proton-bridge.desktop $installdir/usr/share/applications/protonmail-bridge.desktop
